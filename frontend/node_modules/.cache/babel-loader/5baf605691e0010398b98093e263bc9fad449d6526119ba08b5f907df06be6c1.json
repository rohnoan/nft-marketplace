{"ast":null,"code":"class d extends Error {\n  constructor(t, r, n) {\n    super(typeof r == \"object\" ? r.message : r || t, {\n      cause: typeof r == \"object\" ? r.cause : n\n    }), this.type = t, this.name = \"TypedError\", Object.setPrototypeOf(this, d.prototype);\n  }\n}\nfunction G(e) {\n  return e.replace(/[A-Z]/g, t => `_${t.toLowerCase()}`);\n}\nfunction we(e) {\n  return e.replace(/_[a-z]/g, t => t[1].toUpperCase());\n}\nconst he = \"ERR_INVALID_VALUE\",\n  me = \"ERR_UNEXPECTED_VALUE\",\n  de = \"ERR_UNEXPECTED_TYPE\",\n  K = \"ERR_PARSE\";\nfunction V(e, t) {\n  const r = {};\n  for (const n in e) {\n    const o = e[n];\n    if (!o) continue;\n    let s, a;\n    typeof o == \"function\" ? (s = n, a = o) : [s, a] = o;\n    try {\n      const c = a(t(s));\n      c !== void 0 && (r[n] = c);\n    } catch (c) {\n      throw new d(K, `Parser for \"${n}\" property failed${s === n ? \"\" : `. Source field: \"${s}\"`}`, c);\n    }\n  }\n  return r;\n}\nfunction Z(e) {\n  let t = e;\n  if (typeof t == \"string\") try {\n    t = JSON.parse(t);\n  } catch (r) {\n    throw new d(he, {\n      cause: r\n    });\n  }\n  if (typeof t != \"object\" || !t || Array.isArray(t)) throw new d(me);\n  return t;\n}\nfunction g(e, t) {\n  return r => {\n    const n = o => {\n      if (!(r && o === void 0)) try {\n        return t(o);\n      } catch (s) {\n        throw new d(K, {\n          message: `\"${e}\" transformer failed to parse the value`,\n          cause: s\n        });\n      }\n    };\n    return /* @__PURE__ */Object.assign(n, {\n      isValid(o) {\n        try {\n          return n(o), !0;\n        } catch {\n          return !1;\n        }\n      }\n    });\n  };\n}\nfunction l(e, t) {\n  return g(t || \"object\", r => {\n    const n = Z(r);\n    return V(e, o => n[o]);\n  });\n}\nfunction R(e) {\n  throw new d(de, `Unexpected value received: ${JSON.stringify(e)}`);\n}\nconst $ = g(\"boolean\", e => {\n    if (typeof e == \"boolean\") return e;\n    const t = String(e);\n    if (t === \"1\" || t === \"true\") return !0;\n    if (t === \"0\" || t === \"false\") return !1;\n    R(e);\n  }),\n  _ = g(\"string\", e => {\n    if (typeof e == \"string\" || typeof e == \"number\") return e.toString();\n    R(e);\n  }),\n  P = g(\"number\", e => {\n    if (typeof e == \"number\") return e;\n    if (typeof e == \"string\") {\n      const t = Number(e);\n      if (!Number.isNaN(t)) return t;\n    }\n    R(e);\n  }),\n  Ee = g(\"date\", e => e instanceof Date ? e : new Date(P()(e) * 1e3));\nfunction z(e, t) {\n  return g(t || \"searchParams\", r => {\n    typeof r != \"string\" && !(r instanceof URLSearchParams) && R(r);\n    const n = typeof r == \"string\" ? new URLSearchParams(r) : r;\n    return V(e, o => {\n      const s = n.get(o);\n      return s === null ? void 0 : s;\n    });\n  });\n}\nfunction j(e) {\n  for (const t in e) e[t] = [G(t), e[t]];\n  return e;\n}\nconst ye = e => {\n  const t = P(),\n    r = P(!0),\n    n = _(),\n    o = _(!0),\n    s = $(!0),\n    a = l(j({\n      addedToAttachmentMenu: s,\n      allowsWriteToPm: s,\n      firstName: n,\n      id: t,\n      isBot: s,\n      isPremium: s,\n      languageCode: o,\n      lastName: o,\n      photoUrl: o,\n      username: o\n    }), \"User\")(!0);\n  return z(j({\n    authDate: Ee(),\n    canSendAfter: r,\n    chat: l(j({\n      id: t,\n      type: n,\n      title: n,\n      photoUrl: o,\n      username: o\n    }), \"Chat\")(!0),\n    chatInstance: o,\n    chatType: o,\n    hash: n,\n    queryId: o,\n    receiver: a,\n    startParam: o,\n    signature: n,\n    user: a\n  }), \"initData\")(e);\n};\nfunction ve(e) {\n  return /^#[\\da-f]{6}$/i.test(e);\n}\nfunction Pe(e) {\n  return /^#[\\da-f]{3}$/i.test(e);\n}\nfunction Re(e) {\n  const t = e.replace(/\\s/g, \"\").toLowerCase();\n  if (ve(t)) return t;\n  if (Pe(t)) {\n    let n = \"#\";\n    for (let o = 0; o < 3; o += 1) n += t[1 + o].repeat(2);\n    return n;\n  }\n  const r = t.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/) || t.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n  if (!r) throw new Error(`Value \"${e}\" does not satisfy any of known RGB formats.`);\n  return r.slice(1).reduce((n, o) => {\n    const s = parseInt(o, 10).toString(16);\n    return n + (s.length === 1 ? \"0\" : \"\") + s;\n  }, \"#\");\n}\nconst Te = g(\"rgb\", e => Re(_()(e))),\n  I = g(\"themeParams\", e => {\n    const t = Te(!0);\n    return Object.entries(Z(e)).reduce((r, [n, o]) => (r[we(n)] = t(o), r), {});\n  });\n// @__NO_SIDE_EFFECTS__\nfunction W(e) {\n  return JSON.stringify(Object.fromEntries(Object.entries(e).map(([t, r]) => [G(t), r])));\n}\nconst Ae = e => {\n  const t = _(),\n    r = _(!0),\n    n = $(!0);\n  return z({\n    botInline: [\"tgWebAppBotInline\", n],\n    defaultColors: [\"tgWebAppDefaultColors\", I(!0)],\n    fullscreen: [\"tgWebAppFullscreen\", n],\n    initData: [\"tgWebAppData\", ye(!0)],\n    initDataRaw: [\"tgWebAppData\", r],\n    platform: [\"tgWebAppPlatform\", t],\n    showSettings: [\"tgWebAppShowSettings\", n],\n    startParam: [\"tgWebAppStartParam\", r],\n    themeParams: [\"tgWebAppThemeParams\", I()],\n    version: [\"tgWebAppVersion\", t]\n  }, \"launchParams\")(e);\n};\n// @__NO_SIDE_EFFECTS__\nfunction Se(e) {\n  const {\n      initDataRaw: t,\n      startParam: r,\n      showSettings: n,\n      botInline: o,\n      fullscreen: s,\n      defaultColors: a\n    } = e,\n    c = new URLSearchParams();\n  return c.set(\"tgWebAppPlatform\", e.platform), c.set(\"tgWebAppThemeParams\", /* @__PURE__ */W(e.themeParams)), c.set(\"tgWebAppVersion\", e.version), t && c.set(\"tgWebAppData\", t), r && c.set(\"tgWebAppStartParam\", r), typeof n == \"boolean\" && c.set(\"tgWebAppShowSettings\", n ? \"1\" : \"0\"), typeof o == \"boolean\" && c.set(\"tgWebAppBotInline\", o ? \"1\" : \"0\"), typeof s == \"boolean\" && c.set(\"tgWebAppFullscreen\", s ? \"1\" : \"0\"), a && c.set(\"tgWebAppDefaultColors\", /* @__PURE__ */W(a)), c.toString();\n}\nconst X = l({\n    eventType: _(),\n    eventData: e => e\n  }, \"miniAppsMessage\"),\n  Y = g(\"fn\", e => {\n    if (typeof e == \"function\") return e;\n    R(e);\n  });\nfunction $e(e) {\n  return !!e && typeof e == \"object\" && !Array.isArray(e);\n}\nconst Ce = l({\n  TelegramWebviewProxy: l({\n    postEvent: Y()\n  })()\n});\nfunction Q(e) {\n  return Ce().isValid(e);\n}\nfunction Ne() {\n  try {\n    return window.self !== window.top;\n  } catch {\n    return !0;\n  }\n}\nvar De = Object.defineProperty,\n  je = (e, t, r) => t in e ? De(e, t, {\n    enumerable: !0,\n    configurable: !0,\n    writable: !0,\n    value: r\n  }) : e[t] = r,\n  ee = (e, t, r) => je(e, typeof t != \"symbol\" ? t + \"\" : t, r);\nclass b extends Error {\n  constructor(t, r, n) {\n    super(typeof r == \"object\" ? r.message : r || t, {\n      cause: typeof r == \"object\" ? r.cause : n\n    }), this.type = t, this.name = \"TypedError\", Object.setPrototypeOf(this, b.prototype);\n  }\n}\nfunction te(e, t, r) {\n  return e.addEventListener(t, r), () => e.removeEventListener(t, r);\n}\nfunction k(...e) {\n  const t = e.flat(1);\n  return [t.push.bind(t), () => {\n    t.forEach(r => {\n      r();\n    });\n  }];\n}\nfunction Ue(e, t) {\n  return e instanceof b && e.type === t;\n}\nfunction L(e) {\n  return t => Ue(t, e);\n}\nconst re = \"ERR_ABORTED\",\n  ne = \"ERR_CANCELED\",\n  oe = \"ERR_TIMED_OUT\";\nfunction M(e) {\n  return new b(re, {\n    cause: e\n  });\n}\nconst nt = L(oe),\n  ot = L(re),\n  st = L(ne);\nfunction F(e, t) {\n  return e.reject = t.reject, e;\n}\nclass w extends Promise {\n  constructor(t, r) {\n    let n, o;\n    typeof t == \"function\" ? (n = t, o = r) : o = t;\n    let s, a;\n    super((c, i) => {\n      o || (o = {});\n      const {\n        abortSignal: u\n      } = o;\n      if (u && u.aborted) return i(M(u.reason));\n      const [f, h] = k(),\n        m = E => (...ge) => (h(), E(...ge)),\n        T = new AbortController(),\n        {\n          signal: A\n        } = T;\n      a = m(E => {\n        T.abort(E), i(E);\n      }), s = m(c), u && f(te(u, \"abort\", () => {\n        a(M(u.reason));\n      }));\n      const {\n        timeout: D\n      } = o;\n      if (D) {\n        const E = setTimeout(() => {\n          a(new b(oe, `Timeout reached: ${D}ms`));\n        }, D);\n        f(() => {\n          clearTimeout(E);\n        });\n      }\n      n && n(s, a, A);\n    }), ee(this, \"reject\"), this.reject = a;\n  }\n  /**\n   * Creates a new BetterPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, r) {\n    return new w((n, o, s) => {\n      try {\n        const a = t(s);\n        return a instanceof Promise ? a.then(n, o) : n(a);\n      } catch (a) {\n        o(a);\n      }\n    }, r);\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new w(r => {\n      r(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new w((r, n) => {\n      n(t);\n    });\n  }\n  /**\n   * Cancels the promise execution.\n   */\n  cancel() {\n    this.reject(new b(ne));\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return F(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, r) {\n    return F(super.then(t, r), this);\n  }\n}\nfunction J(e, t) {\n  return e.resolve = t.resolve, e;\n}\nclass S extends w {\n  constructor(t, r) {\n    let n, o;\n    typeof t == \"function\" ? (n = t, o = r) : o = t;\n    let s;\n    super((a, c, i) => {\n      s = a, n && n(a, c, i);\n    }, o), ee(this, \"resolve\"), this.resolve = s;\n  }\n  /**\n   * Creates a new EnhancedPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, r) {\n    return new S((n, o, s) => w.withFn(t, {\n      abortSignal: s\n    }).then(n, o), r);\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new S(r => {\n      r(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new S((r, n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return J(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, r) {\n    return J(super.then(t, r), this);\n  }\n}\nfunction at(e, t) {\n  return new w(r => {\n    setTimeout(r, e);\n  }, {\n    abortSignal: t\n  });\n}\nfunction se(e) {\n  return `tapps/${e}`;\n}\nfunction We(e, t) {\n  sessionStorage.setItem(se(e), JSON.stringify(t));\n}\nfunction xe(e) {\n  const t = sessionStorage.getItem(se(e));\n  try {\n    return t ? JSON.parse(t) : void 0;\n  } catch {}\n}\nfunction ct(e) {\n  return e.replace(/[A-Z]/g, t => `-${t.toLowerCase()}`);\n}\nfunction it(e) {\n  return e.replace(/[A-Z]/g, t => `_${t.toLowerCase()}`);\n}\nfunction ut(e) {\n  return e.replace(/_[a-z]/g, t => t[1].toUpperCase());\n}\n// @__NO_SIDE_EFFECTS__\nfunction ke(e, t) {\n  t || (t = {});\n  const {\n    textColor: r,\n    bgColor: n,\n    shouldLog: o = !0\n  } = t;\n  function s(a, ...c) {\n    if (!o || typeof o == \"function\" && !o()) return;\n    const i = \"font-weight:bold;padding:0 5px;border-radius:5px\";\n    console[a](`%c${Intl.DateTimeFormat(\"en-GB\", {\n      hour: \"2-digit\",\n      minute: \"2-digit\",\n      second: \"2-digit\",\n      fractionalSecondDigits: 3,\n      timeZone: \"UTC\"\n    }).format(/* @__PURE__ */new Date())}%c / %c${e}`, `${i};background-color: lightblue;color:black`, \"\", `${i};${r ? `color:${r};` : \"\"}${n ? `background-color:${n}` : \"\"}`, ...c);\n  }\n  return [function (...a) {\n    s(\"log\", ...a);\n  }, function (...a) {\n    s(\"error\", ...a);\n  }];\n}\nfunction pt(e, t) {\n  document.documentElement.style.setProperty(e, t);\n}\nfunction ft(e) {\n  document.documentElement.style.removeProperty(e);\n}\nfunction Le(e, t) {\n  t();\n}\n// @__NO_SIDE_EFFECTS__\nfunction y(e, t) {\n  t || (t = {});\n  const r = t.equals || Object.is;\n  let n = [],\n    o = e;\n  const s = u => {\n    if (!r(o, u)) {\n      const f = o;\n      o = u, Le(i, () => {\n        [...n].forEach(([h, m]) => {\n          h(u, f), m && c(h, !0);\n        });\n      });\n    }\n  };\n  function a(u) {\n    const f = typeof u != \"object\" ? {\n      once: u\n    } : u;\n    return {\n      once: f.once || !1,\n      signal: f.signal || !1\n    };\n  }\n  const c = (u, f) => {\n      const h = a(f),\n        m = n.findIndex(([T, A]) => T === u && A.once === h.once && A.signal === h.signal);\n      m >= 0 && n.splice(m, 1);\n    },\n    i = Object.assign(function () {\n      return Oe(i), o;\n    }, {\n      destroy() {\n        n = [];\n      },\n      set: s,\n      reset() {\n        s(e);\n      },\n      sub(u, f) {\n        return n.push([u, a(f)]), () => c(u, f);\n      },\n      unsub: c,\n      unsubAll() {\n        n = n.filter(u => u[1].signal);\n      }\n    });\n  return i;\n}\nconst U = [];\nfunction Oe(e) {\n  U.length && U[U.length - 1].add(e);\n}\nconst ae = /* @__PURE__ */y(!1),\n  [O, qe] = /* @__PURE__ */ke(\"Bridge\", {\n    bgColor: \"#9147ff\",\n    textColor: \"white\",\n    shouldLog: ae\n  }),\n  Ie = {\n    clipboard_text_received: l({\n      req_id: _(),\n      data: e => e === null ? e : _(!0)(e)\n    }, \"clipboard_text_received\"),\n    custom_method_invoked: l({\n      req_id: _(),\n      result: e => e,\n      error: _(!0)\n    }, \"custom_method_invoked\"),\n    popup_closed: g(\"popup_closed\", e => e ? l({\n      button_id: t => t == null ? void 0 : _()(t)\n    })()(e) : {}),\n    viewport_changed: l({\n      height: P(),\n      width: e => e == null ? window.innerWidth : P()(e),\n      is_state_stable: $(),\n      is_expanded: $()\n    }, \"viewport_changed\")\n  };\nfunction Me(e) {\n  const t = window,\n    [, r] = k(\n    // Add listener, which handles events sent from the Telegram web application and also events\n    // generated by the local emitEvent function.\n    te(t, \"message\", n => {\n      if (n.source !== t.parent) return;\n      let o;\n      try {\n        o = X()(n.data);\n      } catch {\n        return;\n      }\n      const {\n          eventType: s,\n          eventData: a\n        } = o,\n        c = Ie[s];\n      try {\n        const i = c ? c()(a) : a;\n        O(\"Event received:\", i ? {\n          eventType: s,\n          eventData: i\n        } : {\n          eventType: s\n        }), e([s, i]);\n      } catch (i) {\n        qe([`An error occurred processing the \"${s}\" event from the Telegram application.`, \"Please, file an issue here:\", \"https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose\"].join(`\n`), o, i);\n      }\n    }));\n  return r;\n}\nconst C = /* @__PURE__ */y(),\n  N = /* @__PURE__ */y();\nfunction ce() {\n  return N() || N.set(Me(C.set)), C;\n}\nconst v = /* @__PURE__ */y({});\nfunction ie(e) {\n  let t = v()[e];\n  return t || (t = /* @__PURE__ */y(void 0, {\n    equals() {\n      return !1;\n    }\n  }), ce().sub(r => {\n    r && r[0] === e && t.set(r[1]);\n  }), v.set({\n    ...v(),\n    [e]: t\n  })), t;\n}\nfunction Fe(e, t, r) {\n  return ie(e).sub(t, r);\n}\nconst Je = \"ERR_METHOD_UNSUPPORTED\",\n  Be = \"ERR_RETRIEVE_LP_FAILED\",\n  He = \"ERR_METHOD_PARAMETER_UNSUPPORTED\",\n  Ge = \"ERR_UNKNOWN_ENV\",\n  Ke = \"ERR_INVOKE_CUSTOM_METHOD_RESPONSE\",\n  ue = /* @__PURE__ */y(\"https://web.telegram.org\");\nfunction pe(e, t) {\n  O(\"Posting event:\", t ? {\n    eventType: e,\n    eventData: t\n  } : {\n    eventType: e\n  });\n  const r = window;\n  if (Q(r)) {\n    r.TelegramWebviewProxy.postEvent(e, JSON.stringify(t));\n    return;\n  }\n  const n = JSON.stringify({\n    eventType: e,\n    eventData: t\n  });\n  if (Ne()) return r.parent.postMessage(n, ue());\n  const {\n    external: o\n  } = r;\n  if (l({\n    notify: Y()\n  })().isValid(o)) {\n    o.notify(n);\n    return;\n  }\n  throw new b(Ge);\n}\nfunction fe(e, t, r) {\n  r || (r = {});\n  const {\n      capture: n\n    } = r,\n    [o, s] = k();\n  return new w(a => {\n    (Array.isArray(t) ? t : [t]).forEach(c => {\n      o(Fe(c, i => {\n        (!n || (Array.isArray(t) ? n({\n          event: c,\n          payload: i\n        }) : n(i))) && a(i);\n      }));\n    }), (r.postEvent || pe)(e, r.params);\n  }, r).finally(s);\n}\nfunction q(e) {\n  return Ae()(e);\n}\nfunction _e(e) {\n  return q(e.replace(/^[^?#]*[?#]/, \"\").replace(/[?#]/g, \"&\"));\n}\nfunction Ve() {\n  return _e(window.location.href);\n}\nfunction Ze() {\n  const e = performance.getEntriesByType(\"navigation\")[0];\n  if (!e) throw new Error(\"Unable to get first navigation entry.\");\n  return _e(e.name);\n}\nconst ze = \"launchParams\";\nfunction Xe() {\n  return q(xe(ze) || \"\");\n}\nfunction le(e) {\n  We(\"launchParams\", /* @__PURE__ */Se(e));\n}\nfunction be(e) {\n  return e instanceof Error ? e.message + (e.cause ? `\n  ${be(e.cause)}` : \"\") : JSON.stringify(e);\n}\nfunction Ye() {\n  const e = [];\n  for (const t of [\n  // Try to retrieve launch parameters from the current location. This method can return\n  // nothing in case, location was changed, and then the page was reloaded.\n  Ve,\n  // Then, try using the lower level API - window.performance.\n  Ze,\n  // Finally, try to extract launch parameters from the session storage.\n  Xe]) try {\n    const r = t();\n    return le(r), r;\n  } catch (r) {\n    e.push(r);\n  }\n  throw new b(Be, [\"Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?\", \"📖 Refer to docs for more information:\", \"https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment\", \"Collected errors:\", ...e.map(t => `— ${be(t)}`)].join(`\n`));\n}\nfunction _t(e) {\n  if (e === \"simple\") try {\n    return Ye(), !0;\n  } catch {\n    return !1;\n  }\n  return w.withFn(async () => {\n    if (Q(window)) return !0;\n    try {\n      return await fe(\"web_app_request_theme\", \"theme_changed\", {\n        timeout: 100\n      }), !0;\n    } catch {\n      return !1;\n    }\n  }, e);\n}\nfunction x(e, t) {\n  window.dispatchEvent(new MessageEvent(\"message\", {\n    data: JSON.stringify({\n      eventType: e,\n      eventData: t\n    }),\n    // We specify window.parent to imitate the case, the parent iframe sent us this event.\n    source: window.parent\n  }));\n}\nfunction Qe(e, t) {\n  if (typeof t == \"string\") try {\n    const {\n      eventType: r\n    } = X()(t);\n    r === \"web_app_request_theme\" && x(\"theme_changed\", {\n      theme_params: JSON.parse(/* @__PURE__ */W(e))\n    }), r === \"web_app_request_viewport\" && x(\"viewport_changed\", {\n      width: window.innerWidth,\n      height: window.innerHeight,\n      is_state_stable: !0,\n      is_expanded: !0\n    });\n  } catch {}\n}\nfunction lt(e) {\n  var n;\n  const t = typeof e == \"string\" ? q(e) : e;\n  le(t);\n  const r = (n = window.TelegramWebviewProxy) == null ? void 0 : n.postEvent;\n  window.TelegramWebviewProxy = {\n    postEvent(o, s) {\n      Qe(t.themeParams, JSON.stringify({\n        eventType: o,\n        eventData: s\n      })), r == null || r(o, s);\n    }\n  }, O(\"Environment was mocked by the mockTelegramEnv function\");\n}\nfunction bt() {\n  [[\"TelegramGameProxy_receiveEvent\"],\n  // Windows Phone.\n  [\"TelegramGameProxy\", \"receiveEvent\"],\n  // Desktop.\n  [\"Telegram\", \"WebView\", \"receiveEvent\"]\n  // Android and iOS.\n  ].forEach(e => {\n    let t = window;\n    e.forEach((r, n, o) => {\n      if (n === o.length - 1) {\n        t[r] = x;\n        return;\n      }\n      r in t || (t[r] = {}), t = t[r];\n    });\n  });\n}\nfunction gt() {\n  [\"TelegramGameProxy_receiveEvent\", \"TelegramGameProxy\", \"Telegram\"].forEach(e => {\n    delete window[e];\n  });\n}\nfunction wt(e, t, r) {\n  ie(e).unsub(t, r);\n}\nfunction ht(e, t) {\n  return ce().sub(e, t);\n}\nfunction mt(e, t) {\n  C.unsub(e, t);\n}\nfunction et(e) {\n  return ({\n    req_id: t\n  }) => t === e;\n}\nfunction B(e) {\n  return e.split(\".\").map(Number);\n}\nfunction tt(e, t) {\n  const r = B(e),\n    n = B(t),\n    o = Math.max(r.length, n.length);\n  for (let s = 0; s < o; s += 1) {\n    const a = r[s] || 0,\n      c = n[s] || 0;\n    if (a !== c) return a > c ? 1 : -1;\n  }\n  return 0;\n}\nfunction p(e, t) {\n  return tt(e, t) <= 0;\n}\nfunction H(e, t, r) {\n  if (typeof r == \"string\") {\n    if (e === \"web_app_open_link\") {\n      if (t === \"try_instant_view\") return p(\"6.4\", r);\n      if (t === \"try_browser\") return p(\"7.6\", r);\n    }\n    if (e === \"web_app_set_header_color\" && t === \"color\") return p(\"6.9\", r);\n    if (e === \"web_app_close\" && t === \"return_back\") return p(\"7.6\", r);\n    if (e === \"web_app_setup_main_button\" && t === \"has_shine_effect\") return p(\"7.10\", r);\n  }\n  switch (e) {\n    case \"web_app_open_tg_link\":\n    case \"web_app_open_invoice\":\n    case \"web_app_setup_back_button\":\n    case \"web_app_set_background_color\":\n    case \"web_app_set_header_color\":\n    case \"web_app_trigger_haptic_feedback\":\n      return p(\"6.1\", t);\n    case \"web_app_open_popup\":\n      return p(\"6.2\", t);\n    case \"web_app_close_scan_qr_popup\":\n    case \"web_app_open_scan_qr_popup\":\n    case \"web_app_read_text_from_clipboard\":\n      return p(\"6.4\", t);\n    case \"web_app_switch_inline_query\":\n      return p(\"6.7\", t);\n    case \"web_app_invoke_custom_method\":\n    case \"web_app_request_write_access\":\n    case \"web_app_request_phone\":\n      return p(\"6.9\", t);\n    case \"web_app_setup_settings_button\":\n      return p(\"6.10\", t);\n    case \"web_app_biometry_get_info\":\n    case \"web_app_biometry_open_settings\":\n    case \"web_app_biometry_request_access\":\n    case \"web_app_biometry_request_auth\":\n    case \"web_app_biometry_update_token\":\n      return p(\"7.2\", t);\n    case \"web_app_setup_swipe_behavior\":\n      return p(\"7.7\", t);\n    case \"web_app_share_to_story\":\n      return p(\"7.8\", t);\n    case \"web_app_setup_secondary_button\":\n    case \"web_app_set_bottom_bar_color\":\n      return p(\"7.10\", t);\n    case \"web_app_request_safe_area\":\n    case \"web_app_request_content_safe_area\":\n    case \"web_app_request_fullscreen\":\n    case \"web_app_exit_fullscreen\":\n    case \"web_app_set_emoji_status\":\n    case \"web_app_add_to_home_screen\":\n    case \"web_app_check_home_screen\":\n    case \"web_app_request_emoji_status_access\":\n      return p(\"8.0\", t);\n    default:\n      return [\"iframe_ready\", \"iframe_will_reload\", \"web_app_close\", \"web_app_data_send\", \"web_app_expand\", \"web_app_open_link\", \"web_app_ready\", \"web_app_request_theme\", \"web_app_request_viewport\", \"web_app_setup_main_button\", \"web_app_setup_closing_behavior\"].includes(e);\n  }\n}\nfunction dt(e, t) {\n  t || (t = \"strict\");\n  const r = typeof t == \"function\" ? t : n => {\n    const {\n      method: o,\n      version: s\n    } = n;\n    let a, c;\n    if (\"param\" in n ? (a = `Parameter \"${n.param}\" of \"${o}\" method is unsupported in Mini Apps version ${s}`, c = He) : (a = `Method \"${o}\" is unsupported in Mini Apps version ${s}`, c = Je), t === \"strict\") throw new b(c, a);\n    return console.warn(a);\n  };\n  return (n, o) => H(n, e) ? $e(o) && n === \"web_app_set_header_color\" && \"color\" in o && !H(n, \"color\", e) ? r({\n    version: e,\n    method: n,\n    param: \"color\"\n  }) : pe(n, o) : r({\n    version: e,\n    method: n\n  });\n}\nfunction Et(e, t, r, n) {\n  return fe(\"web_app_invoke_custom_method\", \"custom_method_invoked\", {\n    ...(n || {}),\n    params: {\n      method: e,\n      params: t,\n      req_id: r\n    },\n    capture: et(r)\n  }).then(({\n    result: o,\n    error: s\n  }) => {\n    if (s) throw new b(Ke, s);\n    return o;\n  });\n}\nfunction rt(e) {\n  e.unsubAll(), e.reset();\n}\nfunction yt() {\n  var e;\n  (e = N()) == null || e(), [...Object.values(v()), v, C, N, ue, ae].forEach(rt);\n}\nexport { ae as $debug, ue as $targetOrigin, w as CancelablePromise, re as ERR_ABORTED, ne as ERR_CANCELED, Ke as ERR_CUSTOM_METHOD_ERR_RESPONSE, He as ERR_METHOD_PARAMETER_UNSUPPORTED, Je as ERR_METHOD_UNSUPPORTED, Be as ERR_RETRIEVE_LP_FAILED, oe as ERR_TIMED_OUT, Ge as ERR_UNKNOWN_ENV, S as EnhancedPromise, b as TypedError, te as addEventListener, ct as camelToKebab, it as camelToSnake, et as captureSameReq, tt as compareVersions, M as createAbortError, k as createCbCollector, ke as createLogger, dt as createPostEvent, L as createTypedErrorPredicate, bt as defineEventHandlers, ft as deleteCssVar, x as emitMiniAppsEvent, xe as getStorageValue, Q as hasWebviewProxy, Et as invokeCustomMethod, ot as isAbortError, st as isCanceledError, Ne as isIframe, _t as isTMA, nt as isTimeoutError, lt as mockTelegramEnv, wt as off, Fe as on, pe as postEvent, gt as removeEventHandlers, fe as request, yt as resetPackageState, Ye as retrieveLaunchParams, pt as setCssVar, We as setStorageValue, at as sleep, ut as snakeToCamel, ht as subscribe, H as supports, mt as unsubscribe };","map":{"version":3,"names":["d","Error","constructor","t","r","n","message","cause","type","name","Object","setPrototypeOf","prototype","G","e","replace","toLowerCase","we","toUpperCase","he","me","de","K","V","o","s","a","c","Z","JSON","parse","Array","isArray","g","assign","isValid","l","R","stringify","$","String","_","toString","P","Number","isNaN","Ee","Date","z","URLSearchParams","get","j","ye","addedToAttachmentMenu","allowsWriteToPm","firstName","id","isBot","isPremium","languageCode","lastName","photoUrl","username","authDate","canSendAfter","chat","title","chatInstance","chatType","hash","queryId","receiver","startParam","signature","user","ve","test","Pe","Re","repeat","match","slice","reduce","parseInt","length","Te","I","entries","W","fromEntries","map","Ae","botInline","defaultColors","fullscreen","initData","initDataRaw","platform","showSettings","themeParams","version","Se","set","X","eventType","eventData","Y","$e","Ce","TelegramWebviewProxy","postEvent","Q","Ne","window","self","top","De","defineProperty","je","enumerable","configurable","writable","value","ee","E","b","te","addEventListener","removeEventListener","k","flat","push","bind","forEach","Ue","L","re","ne","oe","M","nt","ot","st","F","reject","w","Promise","i","abortSignal","u","aborted","reason","f","h","m","ge","T","AbortController","signal","A","abort","timeout","D","setTimeout","clearTimeout","withFn","then","resolve","cancel","catch","finally","J","S","at","se","We","sessionStorage","setItem","xe","getItem","ct","it","ut","ke","textColor","bgColor","shouldLog","console","Intl","DateTimeFormat","hour","minute","second","fractionalSecondDigits","timeZone","format","pt","document","documentElement","style","setProperty","ft","removeProperty","Le","y","equals","is","once","findIndex","splice","Oe","destroy","reset","sub","unsub","unsubAll","filter","U","add","ae","O","qe","Ie","clipboard_text_received","req_id","data","custom_method_invoked","result","error","popup_closed","button_id","viewport_changed","height","width","innerWidth","is_state_stable","is_expanded","Me","source","parent","join","C","N","ce","v","ie","Fe","Je","Be","He","Ge","Ke","ue","pe","postMessage","external","notify","fe","capture","event","payload","params","q","_e","Ve","location","href","Ze","performance","getEntriesByType","ze","Xe","le","be","Ye","_t","x","dispatchEvent","MessageEvent","Qe","theme_params","innerHeight","lt","bt","gt","wt","ht","mt","et","B","split","tt","Math","max","p","H","includes","dt","method","param","warn","Et","rt","yt","values"],"sources":["C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\transformers\\dist\\index.js","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\env\\hasWebviewProxy.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\env\\isIframe.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\toolkit\\dist\\index.js","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\signals\\dist\\index.js","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\debug.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\transformers.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\lastEvent.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\signalFor.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\on.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\errors.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\methods\\$targetOrigin.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\methods\\postEvent.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\utils\\request.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\parseLaunchParams.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\retrieveFromUrl.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\retrieveFromLocation.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\retrieveFromPerformance.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\storage.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\launch-params\\retrieveLaunchParams.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\env\\isTMA.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\emitMiniAppsEvent.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\env\\mockTelegramEnv.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\defineEventHandlers.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\removeEventHandlers.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\off.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\subscribe.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\events\\listening\\unsubscribe.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\methods\\captureSameReq.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\utils\\compareVersions.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\methods\\supports.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\methods\\createPostEvent.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\utils\\invokeCustomMethod.ts","C:\\Users\\ROHAN\\Desktop\\projects\\nft-marketplace\\frontend\\node_modules\\@telegram-apps\\bridge\\src\\resetPackageState.ts"],"sourcesContent":["class u extends Error {\n  constructor(e, r, n) {\n    super(\n      typeof r == \"object\" ? r.message : r || e,\n      {\n        cause: typeof r == \"object\" ? r.cause : n\n      }\n    ), this.type = e, this.name = \"TypedError\", Object.setPrototypeOf(this, u.prototype);\n  }\n}\nfunction h(t) {\n  return t.replace(/[A-Z]/g, (e) => `_${e.toLowerCase()}`);\n}\nfunction S(t) {\n  return t.replace(/_[a-z]/g, (e) => e[1].toUpperCase());\n}\nconst w = \"ERR_INVALID_VALUE\", D = \"ERR_UNEXPECTED_VALUE\", W = \"ERR_UNEXPECTED_TYPE\", d = \"ERR_PARSE\";\nfunction A(t, e) {\n  const r = {};\n  for (const n in t) {\n    const o = t[n];\n    if (!o)\n      continue;\n    let a, c;\n    typeof o == \"function\" ? (a = n, c = o) : [a, c] = o;\n    try {\n      const s = c(e(a));\n      s !== void 0 && (r[n] = s);\n    } catch (s) {\n      throw new u(\n        d,\n        `Parser for \"${n}\" property failed${a === n ? \"\" : `. Source field: \"${a}\"`}`,\n        s\n      );\n    }\n  }\n  return r;\n}\nfunction P(t) {\n  let e = t;\n  if (typeof e == \"string\")\n    try {\n      e = JSON.parse(e);\n    } catch (r) {\n      throw new u(w, { cause: r });\n    }\n  if (typeof e != \"object\" || !e || Array.isArray(e))\n    throw new u(D);\n  return e;\n}\nfunction i(t, e) {\n  return (r) => {\n    const n = (o) => {\n      if (!(r && o === void 0))\n        try {\n          return e(o);\n        } catch (a) {\n          throw new u(d, {\n            message: `\"${t}\" transformer failed to parse the value`,\n            cause: a\n          });\n        }\n    };\n    return /* @__PURE__ */ Object.assign(\n      n,\n      {\n        isValid(o) {\n          try {\n            return n(o), !0;\n          } catch {\n            return !1;\n          }\n        }\n      }\n    );\n  };\n}\nfunction m(t, e) {\n  return i(e || \"object\", (r) => {\n    const n = P(r);\n    return A(t, (o) => n[o]);\n  });\n}\nfunction p(t) {\n  throw new u(W, `Unexpected value received: ${JSON.stringify(t)}`);\n}\nconst E = i(\"boolean\", (t) => {\n  if (typeof t == \"boolean\")\n    return t;\n  const e = String(t);\n  if (e === \"1\" || e === \"true\")\n    return !0;\n  if (e === \"0\" || e === \"false\")\n    return !1;\n  p(t);\n}), f = i(\"string\", (t) => {\n  if (typeof t == \"string\" || typeof t == \"number\")\n    return t.toString();\n  p(t);\n}), g = i(\"number\", (t) => {\n  if (typeof t == \"number\")\n    return t;\n  if (typeof t == \"string\") {\n    const e = Number(t);\n    if (!Number.isNaN(e))\n      return e;\n  }\n  p(t);\n}), U = i(\"date\", (t) => t instanceof Date ? t : new Date(g()(t) * 1e3));\nfunction R(t, e) {\n  return i(e || \"searchParams\", (r) => {\n    typeof r != \"string\" && !(r instanceof URLSearchParams) && p(r);\n    const n = typeof r == \"string\" ? new URLSearchParams(r) : r;\n    return A(t, (o) => {\n      const a = n.get(o);\n      return a === null ? void 0 : a;\n    });\n  });\n}\nfunction l(t) {\n  for (const e in t)\n    t[e] = [h(e), t[e]];\n  return t;\n}\nconst N = (t) => {\n  const e = g(), r = g(!0), n = f(), o = f(!0), a = E(!0), c = m(l({\n    addedToAttachmentMenu: a,\n    allowsWriteToPm: a,\n    firstName: n,\n    id: e,\n    isBot: a,\n    isPremium: a,\n    languageCode: o,\n    lastName: o,\n    photoUrl: o,\n    username: o\n  }), \"User\")(!0);\n  return R(\n    l({\n      authDate: U(),\n      canSendAfter: r,\n      chat: m(\n        l({\n          id: e,\n          type: n,\n          title: n,\n          photoUrl: o,\n          username: o\n        }),\n        \"Chat\"\n      )(!0),\n      chatInstance: o,\n      chatType: o,\n      hash: n,\n      queryId: o,\n      receiver: c,\n      startParam: o,\n      signature: n,\n      user: c\n    }),\n    \"initData\"\n  )(t);\n};\nfunction O(t) {\n  return /^#[\\da-f]{6}$/i.test(t);\n}\nfunction T(t) {\n  return /^#[\\da-f]{3}$/i.test(t);\n}\nfunction _(t) {\n  const e = t.replace(/\\s/g, \"\").toLowerCase();\n  if (O(e))\n    return e;\n  if (T(e)) {\n    let n = \"#\";\n    for (let o = 0; o < 3; o += 1)\n      n += e[1 + o].repeat(2);\n    return n;\n  }\n  const r = e.match(/^rgb\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3})\\)$/) || e.match(/^rgba\\((\\d{1,3}),(\\d{1,3}),(\\d{1,3}),\\d{1,3}\\)$/);\n  if (!r)\n    throw new Error(`Value \"${t}\" does not satisfy any of known RGB formats.`);\n  return r.slice(1).reduce((n, o) => {\n    const a = parseInt(o, 10).toString(16);\n    return n + (a.length === 1 ? \"0\" : \"\") + a;\n  }, \"#\");\n}\nconst C = i(\"rgb\", (t) => _(f()(t))), b = i(\n  \"themeParams\",\n  (t) => {\n    const e = C(!0);\n    return Object.entries(P(t)).reduce((r, [n, o]) => (r[S(n)] = e(o), r), {});\n  }\n);\n// @__NO_SIDE_EFFECTS__\nfunction y(t) {\n  return JSON.stringify(\n    Object.fromEntries(\n      Object.entries(t).map(([e, r]) => [h(e), r])\n    )\n  );\n}\nconst V = (t) => {\n  const e = f(), r = f(!0), n = E(!0);\n  return R({\n    botInline: [\"tgWebAppBotInline\", n],\n    defaultColors: [\"tgWebAppDefaultColors\", b(!0)],\n    fullscreen: [\"tgWebAppFullscreen\", n],\n    initData: [\"tgWebAppData\", N(!0)],\n    initDataRaw: [\"tgWebAppData\", r],\n    platform: [\"tgWebAppPlatform\", e],\n    showSettings: [\"tgWebAppShowSettings\", n],\n    startParam: [\"tgWebAppStartParam\", r],\n    themeParams: [\"tgWebAppThemeParams\", b()],\n    version: [\"tgWebAppVersion\", e]\n  }, \"launchParams\")(t);\n};\n// @__NO_SIDE_EFFECTS__\nfunction $(t) {\n  const {\n    initDataRaw: e,\n    startParam: r,\n    showSettings: n,\n    botInline: o,\n    fullscreen: a,\n    defaultColors: c\n  } = t, s = new URLSearchParams();\n  return s.set(\"tgWebAppPlatform\", t.platform), s.set(\"tgWebAppThemeParams\", /* @__PURE__ */ y(t.themeParams)), s.set(\"tgWebAppVersion\", t.version), e && s.set(\"tgWebAppData\", e), r && s.set(\"tgWebAppStartParam\", r), typeof n == \"boolean\" && s.set(\"tgWebAppShowSettings\", n ? \"1\" : \"0\"), typeof o == \"boolean\" && s.set(\"tgWebAppBotInline\", o ? \"1\" : \"0\"), typeof a == \"boolean\" && s.set(\"tgWebAppFullscreen\", a ? \"1\" : \"0\"), c && s.set(\"tgWebAppDefaultColors\", /* @__PURE__ */ y(c)), s.toString();\n}\nconst j = m({\n  eventType: f(),\n  eventData: (t) => t\n}, \"miniAppsMessage\");\nfunction L(t, e) {\n  return i(e || \"array\", (r) => {\n    let n;\n    if (Array.isArray(r))\n      n = r;\n    else if (typeof r == \"string\")\n      try {\n        const o = JSON.parse(r);\n        Array.isArray(o) && (n = o);\n      } catch {\n      }\n    return n || p(r), n.map(t);\n  });\n}\nconst I = i(\"fn\", (t) => {\n  if (typeof t == \"function\")\n    return t;\n  p(t);\n});\nfunction B(t) {\n  return !!t && typeof t == \"object\" && !Array.isArray(t);\n}\nexport {\n  w as ERR_INVALID_VALUE,\n  d as ERR_PARSE,\n  W as ERR_UNEXPECTED_TYPE,\n  D as ERR_UNEXPECTED_VALUE,\n  L as array,\n  E as boolean,\n  i as createTransformerGen,\n  U as date,\n  I as fn,\n  N as initData,\n  O as isRGB,\n  T as isRGBShort,\n  B as isRecord,\n  V as launchParams,\n  j as miniAppsMessage,\n  g as number,\n  m as object,\n  C as rgb,\n  R as searchParams,\n  $ as serializeLaunchParams,\n  y as serializeThemeParams,\n  f as string,\n  b as themeParams,\n  _ as toRGB,\n  P as toRecord\n};\n//# sourceMappingURL=index.js.map\n","import { object, fn } from '@telegram-apps/transformers';\n\ninterface WithWebviewProxy {\n  TelegramWebviewProxy: {\n    postEvent: (...args: unknown[]) => unknown;\n  };\n}\n\nconst webViewProxy = object<WithWebviewProxy>({\n  TelegramWebviewProxy: object({ postEvent: fn() })(),\n});\n\n/**\n * Returns true in case, passed value contains path `TelegramWebviewProxy.postEvent` property and\n * `postEvent` is a function.\n * @param value - value to check.\n */\nexport function hasWebviewProxy<T>(value: T): value is T & WithWebviewProxy {\n  return webViewProxy().isValid(value);\n}\n","/**\n * @see https://stackoverflow.com/a/326076\n * @returns True, if current environment is iframe.\n */\nexport function isIframe(): boolean {\n  try {\n    return window.self !== window.top;\n  } catch {\n    return true;\n  }\n}\n","var k = Object.defineProperty;\nvar I = (r, e, t) => e in r ? k(r, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) : r[e] = t;\nvar E = (r, e, t) => I(r, typeof e != \"symbol\" ? e + \"\" : e, t);\nclass d extends Error {\n  constructor(e, t, n) {\n    super(\n      typeof t == \"object\" ? t.message : t || e,\n      {\n        cause: typeof t == \"object\" ? t.cause : n\n      }\n    ), this.type = e, this.name = \"TypedError\", Object.setPrototypeOf(this, d.prototype);\n  }\n}\nfunction x(r, e, t) {\n  return r.addEventListener(e, t), () => r.removeEventListener(e, t);\n}\nfunction _(...r) {\n  const e = r.flat(1);\n  return [\n    e.push.bind(e),\n    () => {\n      e.forEach((t) => {\n        t();\n      });\n    }\n  ];\n}\nfunction F(r, e) {\n  return r instanceof d && r.type === e;\n}\nfunction m(r) {\n  return (e) => F(e, r);\n}\nconst R = \"ERR_ABORTED\", $ = \"ERR_CANCELED\", S = \"ERR_TIMED_OUT\";\nfunction T(r) {\n  return new d(R, { cause: r });\n}\nconst U = m(S), V = m(R), B = m($);\nfunction C(r, e) {\n  return r.reject = e.reject, r;\n}\nclass i extends Promise {\n  constructor(t, n) {\n    let o, s;\n    typeof t == \"function\" ? (o = t, s = n) : s = t;\n    let u, c;\n    super((a, h) => {\n      s || (s = {});\n      const { abortSignal: l } = s;\n      if (l && l.aborted)\n        return h(T(l.reason));\n      const [y, A] = _(), b = (f) => (...L) => (A(), f(...L)), w = new AbortController(), { signal: D } = w;\n      c = b((f) => {\n        w.abort(f), h(f);\n      }), u = b(a), l && y(\n        x(l, \"abort\", () => {\n          c(T(l.reason));\n        })\n      );\n      const { timeout: g } = s;\n      if (g) {\n        const f = setTimeout(() => {\n          c(new d(S, `Timeout reached: ${g}ms`));\n        }, g);\n        y(() => {\n          clearTimeout(f);\n        });\n      }\n      o && o(u, c, D);\n    });\n    /**\n     * Rejects the promise.\n     */\n    E(this, \"reject\");\n    this.reject = c;\n  }\n  /**\n   * Creates a new BetterPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, n) {\n    return new i((o, s, u) => {\n      try {\n        const c = t(u);\n        return c instanceof Promise ? c.then(o, s) : o(c);\n      } catch (c) {\n        s(c);\n      }\n    }, n);\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new i((n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new i((n, o) => {\n      o(t);\n    });\n  }\n  /**\n   * Cancels the promise execution.\n   */\n  cancel() {\n    this.reject(new d($));\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return C(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, n) {\n    return C(super.then(t, n), this);\n  }\n}\nfunction v(r, e) {\n  return r.resolve = e.resolve, r;\n}\nclass p extends i {\n  constructor(t, n) {\n    let o, s;\n    typeof t == \"function\" ? (o = t, s = n) : s = t;\n    let u;\n    super((c, a, h) => {\n      u = c, o && o(c, a, h);\n    }, s);\n    /**\n     * Resolves the promise.\n     */\n    E(this, \"resolve\");\n    this.resolve = u;\n  }\n  /**\n   * Creates a new EnhancedPromise instance using executor, resolving promise when a result\n   * was returned.\n   * @param fn - function returning promise result.\n   * @param options - additional options.\n   */\n  static withFn(t, n) {\n    return new p(\n      (o, s, u) => i.withFn(t, { abortSignal: u }).then(o, s),\n      n\n    );\n  }\n  /**\n   * @see Promise.resolve\n   */\n  static resolve(t) {\n    return new p((n) => {\n      n(t);\n    });\n  }\n  /**\n   * @see Promise.reject\n   */\n  static reject(t) {\n    return new p((n, o) => {\n      o(t);\n    });\n  }\n  /**\n   * @see Promise.catch\n   */\n  catch(t) {\n    return this.then(void 0, t);\n  }\n  /**\n   * @see Promise.finally\n   */\n  finally(t) {\n    return v(super.finally(t), this);\n  }\n  /**\n   * @see Promise.then\n   */\n  then(t, n) {\n    return v(super.then(t, n), this);\n  }\n}\nfunction Z(r, e) {\n  return new i((t) => {\n    setTimeout(t, r);\n  }, { abortSignal: e });\n}\nfunction j(r) {\n  return `tapps/${r}`;\n}\nfunction J(r, e) {\n  sessionStorage.setItem(j(r), JSON.stringify(e));\n}\nfunction K(r) {\n  const e = sessionStorage.getItem(j(r));\n  try {\n    return e ? JSON.parse(e) : void 0;\n  } catch {\n  }\n}\nfunction M(r) {\n  return r.replace(/[A-Z]/g, (e) => `-${e.toLowerCase()}`);\n}\nfunction z(r) {\n  return r.replace(/[A-Z]/g, (e) => `_${e.toLowerCase()}`);\n}\nfunction G(r) {\n  return r.replace(/_[a-z]/g, (e) => e[1].toUpperCase());\n}\n// @__NO_SIDE_EFFECTS__\nfunction q(r, e) {\n  e || (e = {});\n  const {\n    textColor: t,\n    bgColor: n,\n    shouldLog: o = !0\n  } = e;\n  function s(u, ...c) {\n    if (!o || typeof o == \"function\" && !o())\n      return;\n    const a = \"font-weight:bold;padding:0 5px;border-radius:5px\";\n    console[u](\n      `%c${Intl.DateTimeFormat(\"en-GB\", {\n        hour: \"2-digit\",\n        minute: \"2-digit\",\n        second: \"2-digit\",\n        fractionalSecondDigits: 3,\n        timeZone: \"UTC\"\n      }).format(/* @__PURE__ */ new Date())}%c / %c${r}`,\n      `${a};background-color: lightblue;color:black`,\n      \"\",\n      `${a};${t ? `color:${t};` : \"\"}${n ? `background-color:${n}` : \"\"}`,\n      ...c\n    );\n  }\n  return [\n    function(...c) {\n      s(\"log\", ...c);\n    },\n    function(...c) {\n      s(\"error\", ...c);\n    }\n  ];\n}\nfunction H(r, e) {\n  document.documentElement.style.setProperty(r, e);\n}\nfunction P(r) {\n  document.documentElement.style.removeProperty(r);\n}\nexport {\n  i as CancelablePromise,\n  R as ERR_ABORTED,\n  $ as ERR_CANCELED,\n  S as ERR_TIMED_OUT,\n  p as EnhancedPromise,\n  d as TypedError,\n  x as addEventListener,\n  M as camelToKebab,\n  z as camelToSnake,\n  T as createAbortError,\n  _ as createCbCollector,\n  q as createLogger,\n  m as createTypedErrorPredicate,\n  P as deleteCssVar,\n  K as getStorageValue,\n  V as isAbortError,\n  B as isCanceledError,\n  F as isErrorOfType,\n  U as isTimeoutError,\n  H as setCssVar,\n  J as setStorageValue,\n  Z as sleep,\n  G as snakeToCamel\n};\n//# sourceMappingURL=index.js.map\n","let r;\nfunction y(e, c) {\n  r && r.set(e, c) || c();\n}\nfunction m(e) {\n  if (r)\n    return e();\n  r = /* @__PURE__ */ new Map();\n  try {\n    e();\n  } finally {\n    r.forEach((c) => c()), r = void 0;\n  }\n}\n// @__NO_SIDE_EFFECTS__\nfunction S(e, c) {\n  c || (c = {});\n  const g = c.equals || Object.is;\n  let u = [], s = e;\n  const i = (t) => {\n    if (!g(s, t)) {\n      const l = s;\n      s = t, y(o, () => {\n        [...u].forEach(([f, d]) => {\n          f(t, l), d && n(f, !0);\n        });\n      });\n    }\n  };\n  function a(t) {\n    const l = typeof t != \"object\" ? { once: t } : t;\n    return {\n      once: l.once || !1,\n      signal: l.signal || !1\n    };\n  }\n  const n = (t, l) => {\n    const f = a(l), d = u.findIndex(([h, p]) => h === t && p.once === f.once && p.signal === f.signal);\n    d >= 0 && u.splice(d, 1);\n  }, o = Object.assign(\n    function() {\n      return j(o), s;\n    },\n    {\n      destroy() {\n        u = [];\n      },\n      set: i,\n      reset() {\n        i(e);\n      },\n      sub(t, l) {\n        return u.push([t, a(l)]), () => n(t, l);\n      },\n      unsub: n,\n      unsubAll() {\n        u = u.filter((t) => t[1].signal);\n      }\n    }\n  );\n  return o;\n}\nconst b = [];\nfunction j(e) {\n  b.length && b[b.length - 1].add(e);\n}\n// @__NO_SIDE_EFFECTS__\nfunction x(e, c) {\n  let g = /* @__PURE__ */ new Set(), u;\n  function s() {\n    return u || (u = /* @__PURE__ */ S(a(), c));\n  }\n  function i() {\n    s().set(a());\n  }\n  function a() {\n    g.forEach((t) => {\n      t.unsub(i, { signal: !0 });\n    });\n    const n = /* @__PURE__ */ new Set();\n    let o;\n    b.push(n);\n    try {\n      o = e();\n    } finally {\n      b.pop();\n    }\n    return n.forEach((t) => {\n      t.sub(i, { signal: !0 });\n    }), g = n, o;\n  }\n  return Object.assign(function() {\n    return s()();\n  }, {\n    destroy() {\n      s().destroy();\n    },\n    sub(...n) {\n      return s().sub(...n);\n    },\n    unsub(...n) {\n      s().unsub(...n);\n    },\n    unsubAll(...n) {\n      s().unsubAll(...n);\n    }\n  });\n}\nexport {\n  m as batch,\n  x as computed,\n  S as signal\n};\n//# sourceMappingURL=index.js.map\n","import { signal } from '@telegram-apps/signals';\nimport { createLogger } from '@telegram-apps/toolkit';\n\n/**\n * The package debug mode.\n *\n * Enabling debug mode leads to printing additional messages in the console related to the\n * processes inside the package.\n */\nexport const $debug = signal(false);\n\nexport const [logInfo, logError] = createLogger('Bridge', {\n  bgColor: '#9147ff',\n  textColor: 'white',\n  shouldLog: $debug,\n});\n","import {\n  boolean,\n  createTransformerGen,\n  number,\n  object,\n  string,\n  type TransformerGen,\n} from '@telegram-apps/transformers';\n\nimport type { EventName, EventPayload } from '@/events/types/events.js';\n\n/**\n * Transformers for problematic Mini Apps events.\n */\nexport const transformers: { [E in EventName]?: TransformerGen<EventPayload<E>> } = {\n  clipboard_text_received: object({\n    req_id: string(),\n    data: (value) => (value === null ? value : string(true)(value)),\n  }, 'clipboard_text_received'),\n  custom_method_invoked: object({\n    req_id: string(),\n    result: (value) => value,\n    error: string(true),\n  }, 'custom_method_invoked'),\n  popup_closed: createTransformerGen('popup_closed', value => {\n    return value\n      ? object({\n        button_id: (value) => (\n          value === null || value === undefined ? undefined : string()(value)\n        ),\n      })()(value)\n      : {};\n  }),\n  viewport_changed: object({\n    height: number(),\n    width: (value) => (\n      value === null || value === undefined\n        ? window.innerWidth\n        : number()(value)\n    ),\n    is_state_stable: boolean(),\n    is_expanded: boolean(),\n  }, 'viewport_changed'),\n};","import { createCbCollector, addEventListener, type If, type IsNever } from '@telegram-apps/toolkit';\nimport { Signal, signal } from '@telegram-apps/signals';\nimport { miniAppsMessage, type MiniAppsMessage } from '@telegram-apps/transformers';\n\nimport { logError, logInfo } from '@/debug.js';\n\nimport { transformers } from '../transformers.js';\nimport type { EventPayload, EventName } from '../types/events.js';\n\nexport type LastEvent = {\n  [E in EventName]: [E, If<IsNever<EventPayload<E>>, undefined, EventPayload<E>>]\n}[EventName];\n\n/**\n * Creates window event listeners, tracking Mini Apps events and calling passed handler with their\n * data.\n * @param onEvent - event callback.\n */\nfunction defineListeners(onEvent: (event: LastEvent) => void): () => void {\n  const w = window;\n  const [, cleanup] = createCbCollector(\n    // Add listener, which handles events sent from the Telegram web application and also events\n    // generated by the local emitEvent function.\n    addEventListener(w, 'message', (event) => {\n      // Ignore non-parent window messages.\n      if (event.source !== w.parent) {\n        return;\n      }\n\n      // Parse incoming event data.\n      let message: MiniAppsMessage;\n      try {\n        message = miniAppsMessage()(event.data);\n      } catch {\n        // We ignore incorrect messages as they could be generated by any other code.\n        return;\n      }\n\n      const { eventType, eventData } = message;\n      const createTransformer = transformers[eventType as keyof typeof transformers];\n\n      try {\n        const transformed = createTransformer\n          ? createTransformer()(eventData)\n          : eventData;\n        logInfo('Event received:', transformed\n          ? { eventType, eventData: transformed }\n          : { eventType });\n        onEvent([eventType, transformed] as LastEvent);\n      } catch (cause) {\n        logError(\n          [\n            `An error occurred processing the \"${eventType}\" event from the Telegram application.`,\n            'Please, file an issue here:',\n            'https://github.com/Telegram-Mini-Apps/telegram-apps/issues/new/choose',\n          ].join('\\n'),\n          message,\n          cause,\n        );\n      }\n    }),\n  );\n\n  return cleanup;\n}\n\n/**\n * Last received event.\n */\nexport const $lastEvent = signal<LastEvent>();\n\n/**\n * Side effects listening cleanup function. It will be eventually set when some code tried\n * to retrieve the last event.\n */\nexport const $lastEventCleanup = signal<() => void>();\n\n/**\n * Retrieve last received Mini Apps event ensuring that external listeners were defined.\n */\nexport function lastEventSignal(): Signal<LastEvent | undefined> {\n  if (!$lastEventCleanup()) {\n    $lastEventCleanup.set(defineListeners($lastEvent.set));\n  }\n  return $lastEvent;\n}\n\n","import { type Signal, signal } from '@telegram-apps/signals';\n\nimport { lastEventSignal } from '@/events/listening/lastEvent.js';\nimport type { EventName } from '@/events/types/events.js';\nimport type { SignalPayload } from '@/events/listening/types.js';\n\ntype CachedSignal<E extends EventName> = Signal<SignalPayload<E>>;\ntype Cache = {\n  [E in EventName]?: CachedSignal<E>\n};\n\nexport const $eventSignalsCache = signal<Cache>({});\n\n/**\n * Returns a signal for specified event using cache.\n * @param event - event name.\n */\nexport function signalFor<E extends EventName>(event: E): CachedSignal<E> {\n  let cached = $eventSignalsCache()[event];\n  if (!cached) {\n    // This is the special symbol we use to notify signal, that nothing changed, and the current\n    // value should be preserved.\n    cached = signal(undefined, {\n      equals() {\n        // We may receive several undefined in a row. For example,\n        // in the main_button_pressed event.\n        return false;\n      },\n    }) as Cache[E];\n    lastEventSignal().sub(ev => {\n      if (ev && ev[0] === event) {\n        cached!.set(ev[1] as SignalPayload<E>);\n      }\n    });\n\n    $eventSignalsCache.set({ ...$eventSignalsCache(), [event]: cached });\n  }\n\n  return cached as CachedSignal<E>;\n}","import type { RemoveListenerFn } from '@telegram-apps/signals';\n\nimport { signalFor } from '@/events/listening/signalFor.js';\nimport type { EventName } from '@/events/types/events.js';\nimport type { EventListener } from '@/events/listening/types.js';\n\n/**\n * Adds a new listener to the specified event.\n * @param event - event name.\n * @param listener - event listener.\n * @param once - should listener be called only once.\n * @returns Function to remove bound event listener.\n */\nexport function on<E extends EventName>(\n  event: E,\n  listener: EventListener<E>,\n  once?: boolean,\n): RemoveListenerFn {\n  return signalFor(event).sub(listener, once);\n}","export const ERR_METHOD_UNSUPPORTED = 'ERR_METHOD_UNSUPPORTED';\nexport const ERR_RETRIEVE_LP_FAILED = 'ERR_RETRIEVE_LP_FAILED';\nexport const ERR_METHOD_PARAMETER_UNSUPPORTED = 'ERR_METHOD_PARAMETER_UNSUPPORTED';\nexport const ERR_UNKNOWN_ENV = 'ERR_UNKNOWN_ENV';\nexport const ERR_CUSTOM_METHOD_ERR_RESPONSE = 'ERR_INVOKE_CUSTOM_METHOD_RESPONSE';\n","import { signal } from '@telegram-apps/signals';\n\n/**\n * Target origin used by the `postEvent` method.\n *\n * You don't need to override this value until you know what you are doing.\n * @default 'https://web.telegram.org'\n */\nexport const $targetOrigin = signal('https://web.telegram.org');\n","import { fn, object } from '@telegram-apps/transformers';\nimport { TypedError } from '@telegram-apps/toolkit';\n\nimport { logInfo } from '@/debug.js';\nimport { isIframe } from '@/env/isIframe.js';\nimport { hasWebviewProxy } from '@/env/hasWebviewProxy.js';\nimport { ERR_UNKNOWN_ENV } from '@/errors.js';\nimport { $targetOrigin } from '@/methods/$targetOrigin.js';\nimport type {\n  MethodName,\n  MethodNameWithOptionalParams,\n  MethodNameWithoutParams,\n  MethodNameWithRequiredParams,\n  MethodParams,\n} from '@/methods/types/index.js';\n\nexport type PostEventFn = typeof postEvent;\n\n/**\n * Calls Mini Apps methods requiring parameters.\n * @param method - method name.\n * @param params - options along with params.\n * @throws {TypedError} ERR_UNKNOWN_ENV\n */\nexport function postEvent<Method extends MethodNameWithRequiredParams>(\n  method: Method,\n  params: MethodParams<Method>,\n): void;\n\n/**\n * Calls Mini Apps methods accepting no parameters at all.\n * @param method - method name.\n * @throws {TypedError} ERR_UNKNOWN_ENV\n */\nexport function postEvent(method: MethodNameWithoutParams): void;\n\n/**\n * Calls Mini Apps methods accepting optional parameters.\n * @param method - method name.\n * @param params - options along with params.\n * @throws {TypedError} ERR_UNKNOWN_ENV\n */\nexport function postEvent<Method extends MethodNameWithOptionalParams>(\n  method: Method,\n  params?: MethodParams<Method>,\n): void;\n\nexport function postEvent(\n  eventType: MethodName,\n  eventData?: MethodParams<MethodName>,\n): void {\n  logInfo('Posting event:', eventData ? { eventType, eventData } : { eventType });\n\n  const w = window;\n\n  // Telegram for iOS and macOS.\n  if (hasWebviewProxy(w)) {\n    w.TelegramWebviewProxy.postEvent(eventType, JSON.stringify(eventData));\n    return;\n  }\n\n  const message = JSON.stringify({ eventType, eventData });\n\n  // Telegram Web.\n  if (isIframe()) {\n    return w.parent.postMessage(message, $targetOrigin());\n  }\n\n  // Telegram for Windows Phone or Android.\n  const { external } = w;\n  if (object({ notify: fn() })().isValid(external)) {\n    external.notify(message);\n    return;\n  }\n\n  // Otherwise current environment is unknown, and we are not able to send event.\n  throw new TypedError(ERR_UNKNOWN_ENV);\n}\n","import {\n  CancelablePromise,\n  createCbCollector,\n  type If,\n  type IsNever,\n} from '@telegram-apps/toolkit';\n\nimport { on } from '@/events/listening/on.js';\nimport { postEvent } from '@/methods/postEvent.js';\nimport type {\n  MethodName,\n  MethodNameWithOptionalParams,\n  MethodNameWithoutParams,\n  MethodNameWithRequiredParams,\n  MethodParams,\n} from '@/methods/types/index.js';\nimport type { EventName, EventPayload } from '@/events/types/events.js';\nimport type { ExecuteWithOptions } from '@/types.js';\n\ntype AnyEventName = EventName | EventName[];\n\nexport type RequestCaptureFnEventsPayload<E extends EventName[]> = E extends (infer U extends EventName)[]\n  ? {\n    [K in U]: If<\n      IsNever<EventPayload<K>>,\n      { event: K },\n      { event: K; payload: EventPayload<K> }\n    >\n  }[U]\n  : never;\n\nexport type RequestCaptureEventsFn<E extends EventName[]> = (\n  payload: RequestCaptureFnEventsPayload<E>,\n) => boolean\n\nexport type RequestCaptureEventFn<E extends EventName> = If<\n  IsNever<EventPayload<E>>,\n  () => boolean,\n  (payload: EventPayload<E>) => boolean\n>;\n\nexport type RequestCaptureFn<E extends AnyEventName> = E extends EventName[]\n  ? RequestCaptureEventsFn<E>\n  : E extends EventName\n    ? RequestCaptureEventFn<E>\n    : never;\n\nexport interface RequestBasicOptions<E extends AnyEventName> extends ExecuteWithOptions {\n  /**\n   * Should return true if this event should be captured.\n   * The first compatible request will be captured if this property is omitted.\n   */\n  capture?: RequestCaptureFn<E>;\n}\n\nexport type RequestResult<E extends AnyEventName> =\n  E extends (infer U extends EventName)[]\n    ? U extends infer K extends EventName\n      ? If<IsNever<EventPayload<K>>, undefined, EventPayload<K>>\n      : never\n    : E extends EventName\n      ? If<IsNever<EventPayload<E>>, undefined, EventPayload<E>>\n      : never;\n\nexport type RequestFn = typeof request;\n\n/**\n * Performs a request waiting for specified events to occur.\n *\n * This overriding is used for methods, requiring parameters.\n * @param method - method name.\n * @param eventOrEvents - tracked event or events.\n * @param options - additional options.\n */\nexport function request<M extends MethodNameWithRequiredParams, E extends AnyEventName>(\n  method: M,\n  eventOrEvents: E,\n  options: RequestBasicOptions<E> & { params: MethodParams<M> },\n): CancelablePromise<RequestResult<E>>;\n\n/**\n * Performs a request waiting for specified events to occur.\n *\n * This overriding is used for methods with optional parameters.\n * @param method - method name.\n * @param eventOrEvents - tracked event or events.\n * @param options - additional options.\n */\nexport function request<M extends MethodNameWithOptionalParams, E extends AnyEventName>(\n  method: M,\n  eventOrEvents: E,\n  options?: RequestBasicOptions<E> & { params?: MethodParams<M> },\n): CancelablePromise<RequestResult<E>>;\n\n/**\n * Performs a request waiting for specified events to occur.\n *\n * This overriding is used for methods without parameters.\n * @param method - method name.\n * @param eventOrEvents - tracked event or events.\n * @param options - additional options.\n */\nexport function request<M extends MethodNameWithoutParams, E extends AnyEventName>(\n  method: M,\n  eventOrEvents: E,\n  options?: RequestBasicOptions<E>,\n): CancelablePromise<RequestResult<E>>;\n\nexport function request<M extends MethodName, E extends AnyEventName>(\n  method: M,\n  eventOrEvents: E,\n  options?: RequestBasicOptions<E> & { params?: MethodParams<M> },\n): CancelablePromise<RequestResult<E>> {\n  options ||= {};\n  const { capture } = options;\n  const [addCleanup, cleanup] = createCbCollector();\n\n  return new CancelablePromise<RequestResult<E>>((resolve) => {\n    // We need to iterate over all tracked events and create their event listeners.\n    ((Array.isArray(eventOrEvents) ? eventOrEvents : [eventOrEvents])).forEach(event => {\n      // Each event listener waits for the event to occur.\n      // Then, if the capture function was passed, we should check if the event should be captured.\n      // If the function is omitted, we instantly capture the event.\n      addCleanup(\n        on(event, payload => {\n          if (!capture || (\n            Array.isArray(eventOrEvents)\n              ? (capture as RequestCaptureEventsFn<EventName[]>)({\n                event,\n                payload,\n              } as RequestCaptureFnEventsPayload<EventName[]>)\n              : (capture as RequestCaptureEventFn<EventName>)(payload)\n          )) {\n            resolve(payload as RequestResult<E>);\n          }\n        }),\n      );\n    });\n\n    (options.postEvent || postEvent)(method as any, (options as any).params);\n  }, options)\n    .finally(cleanup);\n}\n","import { launchParams, type LaunchParams } from '@telegram-apps/transformers';\n\n/**\n * Parses value as launch parameters.\n * @param value - value to parse.\n */\nexport function parseLaunchParams(value: unknown): LaunchParams {\n  return launchParams()(value);\n}\n","import type { LaunchParams } from '@telegram-apps/types';\n\nimport { parseLaunchParams } from './parseLaunchParams.js';\n\n/**\n * @param urlString - URL to extract launch parameters from.\n * @returns Launch parameters from the specified URL.\n * @throws Error if function was unable to extract launch parameters from the passed URL.\n */\nexport function retrieveFromUrl(urlString: string): LaunchParams {\n  return parseLaunchParams(\n    urlString\n      // Replace everything before this first hashtag or question sign.\n      .replace(/^[^?#]*[?#]/, '')\n      // Replace all hashtags and question signs to make it look like some search params.\n      .replace(/[?#]/g, '&'),\n  );\n}\n","import type { LaunchParams } from '@telegram-apps/types';\n\nimport { retrieveFromUrl } from './retrieveFromUrl.js';\n\n/**\n * @returns Launch parameters from the current window location hash.\n * @throws Error if function was unable to extract launch parameters from the window location hash.\n */\nexport function retrieveFromLocation(): LaunchParams {\n  return retrieveFromUrl(window.location.href);\n}\n","import type { LaunchParams } from '@telegram-apps/types';\n\nimport { retrieveFromUrl } from './retrieveFromUrl.js';\n\n/**\n * @returns Launch parameters based on the first navigation entry.\n * @throws Error if function was unable to extract launch parameters from the navigation entry.\n */\nexport function retrieveFromPerformance(): LaunchParams {\n  const navigationEntry = performance.getEntriesByType('navigation')[0] as PerformanceNavigationTiming | undefined;\n  if (!navigationEntry) {\n    throw new Error('Unable to get first navigation entry.');\n  }\n\n  return retrieveFromUrl(navigationEntry.name);\n}\n","import { getStorageValue, setStorageValue } from '@telegram-apps/toolkit';\nimport { serializeLaunchParams } from '@telegram-apps/transformers';\nimport type { LaunchParams } from '@telegram-apps/types';\n\nimport { parseLaunchParams } from './parseLaunchParams.js';\n\nconst STORAGE_KEY = 'launchParams';\n\n/**\n * @returns Launch parameters stored in the session storage.\n * @throws Error if function was unable to extract launch parameters from the window location hash.\n */\nexport function retrieveFromStorage(): LaunchParams {\n  return parseLaunchParams(getStorageValue(STORAGE_KEY) || '');\n}\n\n/**\n * Saves specified launch parameters in the session storage.\n * @param value - launch params to save.\n */\nexport function saveToStorage(value: LaunchParams): void {\n  setStorageValue('launchParams', serializeLaunchParams(value));\n}\n","import type { LaunchParams } from '@telegram-apps/types';\nimport { TypedError } from '@telegram-apps/toolkit';\n\nimport { ERR_RETRIEVE_LP_FAILED } from '@/errors.js';\n\nimport { retrieveFromLocation } from './retrieveFromLocation.js';\nimport { retrieveFromPerformance } from './retrieveFromPerformance.js';\nimport { retrieveFromStorage, saveToStorage } from './storage.js';\n\nfunction unwrapError(e: unknown): string {\n  if (e instanceof Error) {\n    return e.message + (e.cause ? `\\n  ${unwrapError(e.cause)}` : '');\n  }\n  return JSON.stringify(e);\n}\n\n/**\n * @returns Launch parameters from any known source.\n * @throws {TypedError} ERR_RETRIEVE_LP_FAILED\n */\nexport function retrieveLaunchParams(): LaunchParams {\n  const errors: unknown[] = [];\n\n  for (const retrieve of [\n    // Try to retrieve launch parameters from the current location. This method can return\n    // nothing in case, location was changed, and then the page was reloaded.\n    retrieveFromLocation,\n    // Then, try using the lower level API - window.performance.\n    retrieveFromPerformance,\n    // Finally, try to extract launch parameters from the session storage.\n    retrieveFromStorage,\n  ]) {\n    try {\n      const lp = retrieve();\n      saveToStorage(lp);\n      return lp;\n    } catch (e) {\n      errors.push(e);\n    }\n  }\n\n  throw new TypedError(ERR_RETRIEVE_LP_FAILED, [\n    'Unable to retrieve launch parameters from any known source. Perhaps, you have opened your app outside Telegram?',\n    '📖 Refer to docs for more information:',\n    'https://docs.telegram-mini-apps.com/packages/telegram-apps-bridge/environment',\n    'Collected errors:',\n    ...errors.map(e => `— ${unwrapError(e)}`),\n  ].join('\\n'));\n}\n","import { CancelablePromise, type AsyncOptions } from '@telegram-apps/toolkit';\n\nimport { request } from '@/utils/request.js';\nimport { hasWebviewProxy } from '@/env/hasWebviewProxy.js';\nimport { retrieveLaunchParams } from '@/launch-params/retrieveLaunchParams.js';\n\n/**\n * Returns true if the current environment is Telegram Mini Apps.\n *\n * It uses the `retrieveLaunchParams` function to determine if the environment contains\n * launch parameters. In case it does, true will be returned.\n *\n * In case you need stricter checks, use async override of this function.\n */\nexport function isTMA(type: 'simple'): boolean;\n\n/**\n * Returns promise with true if the current environment is Telegram Mini Apps.\n *\n * First of all, it checks if the current environment contains traits specific to the\n * Mini Apps environment.\n * Then, it attempts to call a Mini Apps method and waits for a response to be received.\n *\n * In case you need less strict checks, use sync override of this function.\n */\nexport function isTMA(options?: AsyncOptions): CancelablePromise<boolean>\n\nexport function isTMA(optionsOrType?: AsyncOptions | 'simple'): boolean | CancelablePromise<boolean> {\n  if (optionsOrType === 'simple') {\n    try {\n      retrieveLaunchParams();\n      return true;\n    } catch {\n      return false;\n    }\n  }\n\n  return CancelablePromise.withFn(async () => {\n    if (hasWebviewProxy(window)) {\n      return true;\n    }\n    try {\n      await request('web_app_request_theme', 'theme_changed', { timeout: 100 });\n      return true;\n    } catch {\n      return false;\n    }\n  }, optionsOrType);\n}\n","/**\n * Emits an event sent from the Telegram native application like it was sent in a default web\n * environment between two iframes.\n *\n * It dispatches a new MessageEvent and expects it to be handled via\n * the `window.addEventListener('message', ...)` call, as a developer would do it to handle\n * messages sent from the parent iframe.\n * @param eventType - event name.\n * @param eventData - event payload.\n */\nexport function emitMiniAppsEvent(eventType: string, eventData?: unknown): void {\n  window.dispatchEvent(new MessageEvent('message', {\n    data: JSON.stringify({ eventType, eventData }),\n    // We specify window.parent to imitate the case, the parent iframe sent us this event.\n    source: window.parent,\n  }));\n}","import {\n  miniAppsMessage,\n  serializeThemeParams,\n  type ThemeParams,\n} from '@telegram-apps/transformers';\nimport type { LaunchParams } from '@telegram-apps/types';\n\nimport { parseLaunchParams } from '@/launch-params/parseLaunchParams.js';\nimport { saveToStorage } from '@/launch-params/storage.js';\nimport { logInfo } from '@/debug.js';\nimport { emitMiniAppsEvent } from '@/events/emitMiniAppsEvent.js';\nimport type { EventPayload } from '@/events/types/index.js';\n\n/**\n * Intercepts the window.parent.postMessage call and performs pre-defined actions. For example,\n * it may handle the request theme request and emit the theme_changed event.\n * @param tp - theme params.\n * @param data - postMessage data.\n */\nfunction imitatePostEvent(tp: ThemeParams, data: unknown): void {\n  if (typeof data !== 'string') {\n    return;\n  }\n  try {\n    const { eventType } = miniAppsMessage()(data);\n\n    if (eventType === 'web_app_request_theme') {\n      emitMiniAppsEvent('theme_changed', {\n        theme_params: JSON.parse(serializeThemeParams(tp)),\n      } satisfies EventPayload<'theme_changed'>);\n    }\n\n    if (eventType === 'web_app_request_viewport') {\n      emitMiniAppsEvent('viewport_changed', {\n        width: window.innerWidth,\n        height: window.innerHeight,\n        is_state_stable: true,\n        is_expanded: true,\n      } satisfies EventPayload<'viewport_changed'>);\n    }\n  } catch {\n  }\n}\n\n/**\n * Mocks a Telegram application environment.\n * @param launchParamsRaw - launch parameters presented as a string or query parameters.\n */\nexport function mockTelegramEnv(launchParamsRaw: LaunchParams | string): void {\n  const lp = typeof launchParamsRaw === 'string'\n    ? parseLaunchParams(launchParamsRaw)\n    : launchParamsRaw;\n\n  // Save launch params in the storage, so retrieveLaunchParams will return them.\n  saveToStorage(lp);\n\n  // Define a special port, expected by the postEvent function.\n  const proxyPostEvent = (window as any).TelegramWebviewProxy?.postEvent;\n  (window as any).TelegramWebviewProxy = {\n    postEvent(eventType: string, eventData: string) {\n      imitatePostEvent(lp.themeParams, JSON.stringify({ eventType, eventData }));\n      proxyPostEvent?.(eventType, eventData);\n    },\n  };\n\n  logInfo('Environment was mocked by the mockTelegramEnv function');\n}","import { emitMiniAppsEvent } from '@/events/emitMiniAppsEvent.js';\n\n/**\n * Defines special handlers by known paths, which Telegram recognizes as ports to receive events.\n */\nexport function defineEventHandlers() {\n  // Iterate over each path, where \"receiveEvent\" function should be\n  // defined. This function is called by external environment in case,\n  // it wants to emit some event.\n  [\n    ['TelegramGameProxy_receiveEvent'], // Windows Phone.\n    ['TelegramGameProxy', 'receiveEvent'], // Desktop.\n    ['Telegram', 'WebView', 'receiveEvent'], // Android and iOS.\n  ].forEach((path) => {\n    // Path starts from the \"window\" object.\n    let pointer = window as Record<string, any>;\n\n    path.forEach((item, idx, arr) => {\n      // We are on the last iteration, where function property name is passed.\n      if (idx === arr.length - 1) {\n        pointer[item] = emitMiniAppsEvent;\n        return;\n      }\n\n      if (!(item in pointer)) {\n        pointer[item] = {};\n      }\n      pointer = pointer[item];\n    });\n  });\n}\n","/**\n * Removes global event handlers, used by the package.\n */\nexport function removeEventHandlers(): void {\n  ['TelegramGameProxy_receiveEvent', 'TelegramGameProxy', 'Telegram'].forEach((prop) => {\n    delete window[prop as keyof Window];\n  });\n}","import { signalFor } from '@/events/listening/signalFor.js';\nimport type { EventName } from '@/events/types/events.js';\nimport type { EventListener } from '@/events/listening/types.js';\n\n/**\n * Removes the listener from the specified event.\n * @param event - event to listen.\n * @param listener - event listener to remove.\n * @param once - had this listener to be called only once.\n */\nexport function off<E extends EventName>(\n  event: E,\n  listener: EventListener<E>,\n  once?: boolean,\n): void {\n  signalFor(event).unsub(listener, once);\n}\n","import type { RemoveListenerFn } from '@telegram-apps/signals';\n\nimport { lastEventSignal } from '@/events/listening/lastEvent.js';\nimport type { SubscribeListener } from '@/events/listening/types.js';\n\n/**\n * Subscribes to all events sent from the native Telegram application.\n * @param listener - event listener to bind.\n * @param once - should this listener be called only once.\n * @returns Function to remove bound event listener.\n */\nexport function subscribe(listener: SubscribeListener, once?: boolean): RemoveListenerFn {\n  return lastEventSignal().sub(listener, once);\n}\n","import type { SubscribeListenerFn } from '@telegram-apps/signals';\n\nimport { $lastEvent, LastEvent } from '@/events/listening/lastEvent.js';\n\n/**\n * Remove a subscriber listening to all events sent from the native Telegram application.\n * @param listener - event listener to remove.\n * @param once - had this listener to be called only once.\n * @returns Function to remove bound event listener.\n */\nexport function unsubscribe(\n  listener: SubscribeListenerFn<LastEvent | undefined>,\n  once?: boolean,\n): void {\n  $lastEvent.unsub(listener, once);\n}\n","type CaptureSameReqFn = (payload: { req_id: string }) => boolean;\n\n/**\n * Returns a function which can be used in `request` function `capture` property to capture\n * the event with the same request identifier.\n * @param reqId - request identifier.\n */\nexport function captureSameReq(reqId: string): CaptureSameReqFn {\n  return ({ req_id }) => req_id === reqId;\n}\n","import type { Version } from '@telegram-apps/types';\n\nfunction parts(a: Version): number[] {\n  return a.split('.').map(Number);\n}\n\n/**\n * @param a - first version.\n * @param b - second version.\n * @returns\n * - `1` if the version \"a\" is greater than \"b\".\n * - `0` the version \"a\" is equal to \"b\".\n * - `-1` the version \"a\" is lower than \"b\".\n */\nexport function compareVersions(a: Version, b: Version): number {\n  const aParts = parts(a);\n  const bParts = parts(b);\n  const len = Math.max(aParts.length, bParts.length);\n\n  // Iterate over each part of versions and compare them. In case, part is\n  // missing, assume its value is equal to 0.\n  for (let i = 0; i < len; i += 1) {\n    const aVal = aParts[i] || 0\n    const bVal = bParts[i] || 0;\n\n    if (aVal === bVal) {\n      continue;\n    }\n    return aVal > bVal ? 1 : -1;\n  }\n  return 0;\n}\n","import type { Version } from '@telegram-apps/types';\n\nimport { compareVersions } from '@/utils/compareVersions.js';\nimport type {\n  MethodName,\n  MethodNameWithVersionedParams,\n  MethodVersionedParams,\n} from '@/methods/types/index.js';\n\n/**\n * Returns true if \"a\" version is less than or equal to \"b\" version.\n * @param a\n * @param b\n */\nfunction versionLessOrEqual(a: Version, b: Version): boolean {\n  return compareVersions(a, b) <= 0;\n}\n\n/**\n * Returns true in case, passed parameter in specified method is supported.\n * @param method - method name\n * @param param - method parameter\n * @param inVersion - platform version.\n */\nexport function supports<M extends MethodNameWithVersionedParams>(\n  method: M,\n  param: MethodVersionedParams<M>,\n  inVersion: Version,\n): boolean;\n\n/**\n * Returns true in case, specified method is supported in a passed version.\n * @param method - method name.\n * @param inVersion - platform version.\n */\nexport function supports(method: MethodName, inVersion: Version): boolean;\n\nexport function supports(\n  method: MethodName,\n  paramOrVersion: Version | string,\n  inVersion?: string,\n): boolean {\n  // Method name, parameter, target version.\n  if (typeof inVersion === 'string') {\n    if (method === 'web_app_open_link') {\n      if (paramOrVersion === 'try_instant_view') {\n        return versionLessOrEqual('6.4', inVersion);\n      }\n      if (paramOrVersion === 'try_browser') {\n        return versionLessOrEqual('7.6', inVersion);\n      }\n    }\n\n    if (method === 'web_app_set_header_color') {\n      if (paramOrVersion === 'color') {\n        return versionLessOrEqual('6.9', inVersion);\n      }\n    }\n\n    if (method === 'web_app_close' && paramOrVersion === 'return_back') {\n      return versionLessOrEqual('7.6', inVersion);\n    }\n\n    if (method === 'web_app_setup_main_button' && paramOrVersion === 'has_shine_effect') {\n      return versionLessOrEqual('7.10', inVersion);\n    }\n  }\n\n  switch (method) {\n    case 'web_app_open_tg_link':\n    case 'web_app_open_invoice':\n    case 'web_app_setup_back_button':\n    case 'web_app_set_background_color':\n    case 'web_app_set_header_color':\n    case 'web_app_trigger_haptic_feedback':\n      return versionLessOrEqual('6.1', paramOrVersion);\n    case 'web_app_open_popup':\n      return versionLessOrEqual('6.2', paramOrVersion);\n    case 'web_app_close_scan_qr_popup':\n    case 'web_app_open_scan_qr_popup':\n    case 'web_app_read_text_from_clipboard':\n      return versionLessOrEqual('6.4', paramOrVersion);\n    case 'web_app_switch_inline_query':\n      return versionLessOrEqual('6.7', paramOrVersion);\n    case 'web_app_invoke_custom_method':\n    case 'web_app_request_write_access':\n    case 'web_app_request_phone':\n      return versionLessOrEqual('6.9', paramOrVersion);\n    case 'web_app_setup_settings_button':\n      return versionLessOrEqual('6.10', paramOrVersion);\n    case 'web_app_biometry_get_info':\n    case 'web_app_biometry_open_settings':\n    case 'web_app_biometry_request_access':\n    case 'web_app_biometry_request_auth':\n    case 'web_app_biometry_update_token':\n      return versionLessOrEqual('7.2', paramOrVersion);\n    case 'web_app_setup_swipe_behavior':\n      return versionLessOrEqual('7.7', paramOrVersion);\n    case 'web_app_share_to_story':\n      return versionLessOrEqual('7.8', paramOrVersion);\n    case 'web_app_setup_secondary_button':\n    case 'web_app_set_bottom_bar_color':\n      return versionLessOrEqual('7.10', paramOrVersion);\n    case 'web_app_request_safe_area':\n    case 'web_app_request_content_safe_area':\n    case 'web_app_request_fullscreen':\n    case 'web_app_exit_fullscreen':\n    case 'web_app_set_emoji_status':\n    case 'web_app_add_to_home_screen':\n    case 'web_app_check_home_screen':\n    case 'web_app_request_emoji_status_access':\n      return versionLessOrEqual('8.0', paramOrVersion);\n    default:\n      return [\n        'iframe_ready',\n        'iframe_will_reload',\n        'web_app_close',\n        'web_app_data_send',\n        'web_app_expand',\n        'web_app_open_link',\n        'web_app_ready',\n        'web_app_request_theme',\n        'web_app_request_viewport',\n        'web_app_setup_main_button',\n        'web_app_setup_closing_behavior',\n      ].includes(method);\n  }\n}\n","import { isRecord } from '@telegram-apps/transformers';\nimport { TypedError } from '@telegram-apps/toolkit';\nimport type { Version } from '@telegram-apps/types';\n\nimport { ERR_METHOD_PARAMETER_UNSUPPORTED, ERR_METHOD_UNSUPPORTED } from '@/errors.js';\nimport { supports } from '@/methods/supports.js';\nimport { type PostEventFn, postEvent } from '@/methods/postEvent.js';\nimport type {\n  MethodName,\n  MethodNameWithVersionedParams,\n  MethodVersionedParams,\n} from '@/methods/types/index.js';\n\nexport type OnUnsupportedFn = (\n  data: { version: Version } & (\n    | { method: MethodName }\n    | {\n    [M in MethodNameWithVersionedParams]: {\n      method: M;\n      param: MethodVersionedParams<M>;\n    };\n  }[MethodNameWithVersionedParams]),\n) => void;\n\nexport type CreatePostEventMode = 'strict' | 'non-strict';\n\n/**\n * Creates a function which checks if specified method and parameters are supported.\n *\n * If method or parameters are unsupported, the `onUnsupported` function will be called.\n *\n * If `strict` or `non-strict` value was passed as the second argument, the function\n * will create its own `onUnsupported` function with behavior depending on the value passed.\n *\n * - Passing `strict` will make function to throw a `TypedError` error\n * with `ERR_METHOD_UNSUPPORTED` or `ERR_METHOD_PARAMETER_UNSUPPORTED` type.\n * - Passing `non-strict` will just warn you about something being unsupported.\n *\n * @param version - Telegram Mini Apps version.\n * @param onUnsupportedOrMode - function or strict mode. Default: `strict`\n */\nexport function createPostEvent(\n  version: Version,\n  onUnsupportedOrMode?: OnUnsupportedFn | CreatePostEventMode,\n): PostEventFn {\n  onUnsupportedOrMode ||= 'strict';\n  const onUnsupported: OnUnsupportedFn = typeof onUnsupportedOrMode === 'function'\n    ? onUnsupportedOrMode\n    : data => {\n      const { method, version } = data;\n      let message: string;\n      let error: string;\n\n      if ('param' in data) {\n        message = `Parameter \"${data.param}\" of \"${method}\" method is unsupported in Mini Apps version ${version}`;\n        error = ERR_METHOD_PARAMETER_UNSUPPORTED;\n      } else {\n        message = `Method \"${method}\" is unsupported in Mini Apps version ${version}`;\n        error = ERR_METHOD_UNSUPPORTED;\n      }\n\n      if (onUnsupportedOrMode === 'strict') {\n        throw new TypedError(error, message);\n      }\n      return console.warn(message);\n    };\n\n  return ((method: any, params: any) => {\n    // Firstly, check if a method is supported.\n    if (!supports(method, version)) {\n      return onUnsupported({ version, method });\n    }\n\n    // Method could use parameters, which are supported only in specific versions of Mini Apps.\n    // We are validating only those parameters, which are not backward compatible.\n    if (\n      isRecord(params)\n      && method === 'web_app_set_header_color'\n      && 'color' in params\n      && !supports(method, 'color', version)\n    ) {\n      return onUnsupported({ version, method, param: 'color' });\n    }\n\n    return postEvent(method, params);\n  }) as PostEventFn;\n}\n","import { CancelablePromise, TypedError } from '@telegram-apps/toolkit';\n\nimport { ERR_CUSTOM_METHOD_ERR_RESPONSE } from '@/errors.js';\nimport { captureSameReq } from '@/methods/captureSameReq.js';\nimport type { ExecuteWithOptions } from '@/types.js';\nimport type { CustomMethodName, CustomMethodParams } from '@/methods/types/index.js';\n\nimport { request } from './request.js';\n\n/**\n * Invokes known custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param requestId - request identifier.\n * @param options - additional options.\n * @throws {TypedError} ERR_CUSTOM_METHOD_ERR_RESPONSE\n */\nexport function invokeCustomMethod<M extends CustomMethodName>(\n  method: M,\n  params: CustomMethodParams<M>,\n  requestId: string,\n  options?: ExecuteWithOptions,\n): CancelablePromise<unknown>;\n\n/**\n * Invokes unknown custom method. Returns method execution result.\n * @param method - method name.\n * @param params - method parameters.\n * @param requestId - request identifier.\n * @param options - additional options.\n * @throws {TypedError} ERR_CUSTOM_METHOD_ERR_RESPONSE\n */\nexport function invokeCustomMethod(\n  method: string,\n  params: object,\n  requestId: string,\n  options?: ExecuteWithOptions,\n): CancelablePromise<unknown>;\n\nexport function invokeCustomMethod(\n  method: string,\n  params: object,\n  requestId: string,\n  options?: ExecuteWithOptions,\n): CancelablePromise<unknown> {\n  return request('web_app_invoke_custom_method', 'custom_method_invoked', {\n    ...options || {},\n    params: { method, params, req_id: requestId },\n    capture: captureSameReq(requestId),\n  })\n    .then(({ result, error }) => {\n      if (error) {\n        throw new TypedError(ERR_CUSTOM_METHOD_ERR_RESPONSE, error);\n      }\n      return result;\n    });\n}\n","import type { Signal } from '@telegram-apps/signals';\n\nimport { $eventSignalsCache } from '@/events/listening/signalFor.js';\nimport { $lastEvent, $lastEventCleanup } from '@/events/listening/lastEvent.js';\nimport { $targetOrigin } from '@/methods/$targetOrigin.js';\nimport { $debug } from '@/debug.js';\n\nfunction resetSignal(s: Signal<any>): void {\n  s.unsubAll();\n  s.reset();\n}\n\n/**\n * Resets the package state. Normally, you don't use this function in your application.\n * We are using it only for test purposes.\n */\nexport function resetPackageState() {\n  $lastEventCleanup()?.();\n\n  [\n    ...Object.values($eventSignalsCache()),\n    $eventSignalsCache,\n    $lastEvent,\n    $lastEventCleanup,\n    $targetOrigin,\n    $debug,\n  ].forEach(resetSignal);\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}